#!/usr/bin/env python3# -*- coding: utf-8 -*-"""Created on Fri Feb 18 12:21:40 2022@author: galengorski"""import itertoolsimport lstm_modeling_functions as lmfimport pandas as pdimport os#%%Run = 'Run_07'out_dir = os.path.join('03_model/out/multi_site',Run)netcdf_loc = '02_munge/out/model_input.nc'config_loc = '03_model/multi_site_model_config.yaml'site_info = pd.read_csv('01_fetch/out/site_list_220128.csv', dtype = {'site_no':str})#input file locationinput_file_loc= '03_model/out/multi_site/Run_00'site_no_list = site_info.site_no[10:26]station_nm_list = site_info.station_nm[10:26]#%%#make sure the same model isnt run again using the same parameterslr = [0.005, 0.007, 0.009]bs = [128,256]do = [0.15]wd = [0.0001]prev_hy_param = list(itertools.product(lr,bs, do, wd))#%%%lr = [0.001,0.005,0.007,0.009]bs = [256]do = [0]wd = [0.0001, 0.001, 0.01]hy_param = list(itertools.product(lr,bs, do, wd))#slim the list down to the hyper parameters that have not already been tested#hy_param_non_redundant = [hp_set for hp_set in hy_param if hp_set not in prev_hy_param]#%%input_file_loc= '03_model/out/multi_site/hyper_param_tune/HP_Run_63'        for i in range(len(hy_param)):     HP_Run_pad = str(74).zfill(2)    HP_Run = 'HP_Run_'+HP_Run_pad    out_dir = os.path.join('03_model/out/multi_site/hyper_param_tune',HP_Run)    hp_tune_vals = {'learning_rate':hy_param[i][0], 'batch_size':hy_param[i][1],                     'dropout':hy_param[i][2], 'weight_decay':hy_param[i][3]}    if i == 0:        read_input_data_from_file = False    else:        read_input_data_from_file = True    hp_tune = True    save_results_csv = False    lmf.run_multi_site_model_c(netcdf_loc, config_loc, site_no_list, station_nm_list, read_input_data_from_file, input_file_loc, out_dir, hp_tune, hp_tune_vals, save_results_csv)    #%%read_input_data_from_file = Falsehp_tune = Falsehp_tune_vals = {}save_results_csv = Falsetrain_model = TrueHP_Run = 'HP_Run_38'input_file_loc= '03_model/out/multi_site/hyper_param_tune/HP_Run_37'out_dir = os.path.join('03_model/out/multi_site/hyper_param_tune',HP_Run)config_loc = '03_model/multi_site_model_config.yaml'lmf.run_multi_site_model_c(netcdf_loc, config_loc, site_no_list, station_nm_list, read_input_data_from_file, input_file_loc, out_dir, train_model, hp_tune, hp_tune_vals, save_results_csv)